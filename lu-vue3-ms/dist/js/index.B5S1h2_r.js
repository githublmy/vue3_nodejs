import{an as R,aj as F,o as g,c as v,g as s,w as i,ak as f,b as p,al as A,F as V,f as b,ae as I,af as q,i as D,bG as Y,am as x,E as N}from"./main.CrQy0rei.js";import{E as T}from"./el-divider.hJGeS1bo.js";import{a as W,E as G}from"./el-form-item.wtASsPiC.js";import"./el-tag.CBx_6nbQ.js";import{E as j}from"./el-row.Bv96wKzH.js";import{E as z}from"./el-color-picker.skGZniGS.js";import{E as O,a as J}from"./el-select.BPwTr14U.js";import{E as M}from"./el-progress.CqWi67kK.js";import{E as P}from"./el-col.C6TD3t-L.js";import{f as h}from"./fabric.A0Le3tjR.js";import{E as Z}from"./useInput.DyB6ZbP4.js";import"./_baseClone.CmRA-Kzl.js";import"./_Uint8Array.BJ3loEHr.js";import"./_initCloneObject.CmUq_dQd.js";import"./isEqual.B76CtRx5.js";import"./debounce.CQa-nK8j.js";var X={VITE_BASE_URL_PREFIX:"/",VITE_TITLE:"production生产环境",VITE_URL_TES:"/src/main.ts",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const L={data(){return{showImg:!0,fontWeightValue:"normal",fontSizeValue:16,optionsFw:[{value:"normal",label:"正常"},{value:"bold",label:"加粗"}],colorValue:"#f00",imgAction:X.VITE_FILE_ACTION,canvas:null,img:null,target:null,isUpload:!1,currentObj:{equipmentId:"",equipmentName:"",equipmentCode:null,latlog:"",quantity:null,status:""},optionsFS:[12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62,64,66,68,70],headers:{},obj:{clientMdCode:"test",uid:""},formData:{photoName:"",photoDesc:"",regionList:[],detailVo:null},rules:{photoName:[{required:!0,message:"请输入名称",trigger:"blur"}]},panning:!1,options:[],value:{},list:[],currentTextBox:null,currentOperateType:1,currentType:""}},mounted(){this.init()},beforeDestroy(){this.canvas.dispose()},methods:{onDragstart(e){this.currentType=e},addImage(){new h.fabric.Image.fromURL("",e=>{const t=this;this.canvas.add(e);function l(){e.animate({opacity:1},{duration:900,onChange:t.canvas.requestRenderAll.bind(t.canvas),onComplete:n})}function n(){e.animate({opacity:.5},{duration:1200,onChange:t.canvas.requestRenderAll.bind(t.canvas),onComplete:l})}l(),this.updateCanvas()})},async getImgDetail(e){const t={storageId:e.storageId};this.formData=e;const l=await getImagInfoDetail(t);this.currentOperateType=2,setTimeout(()=>{this.init(),this.load(l.payload)},500)},goToList(){this.showImg=!1},handleBeforeUpload(e){this.obj.uid=e.uid},load(e){this.canvas.loadFromJSON(e,()=>{this.isUpload=!0})},changeFontSize(){const e=this.canvas.getActiveObject();e&&e.type==="textbox"&&(e.setSelectionStyles({fontSize:this.fontSizeValue}),this.updateCanvas())},changeFontWeight(){const e=this.canvas.getActiveObject();e&&e.type==="textbox"&&(e.setSelectionStyles({fontWeight:this.fontWeightValue}),this.updateCanvas())},changeColor(){const e=this.canvas.getActiveObject();e&&e.type==="textbox"&&(e.setSelectionStyles({fill:this.colorValue}),this.updateCanvas())},activeChange(e){this.colorValue=e;const t=this.canvas.getActiveObject();t&&t.type==="textbox"&&(t.setSelectionStyles({fill:this.colorValue}),this.updateCanvas())},handlerError(e,t,l){this.msgError("上传失败！")},resetAllZoom(){this.canvas.viewportTransform=[1,0,0,1,0,0],this.updateCanvas()},handleUploadSuccess(e){if(!e)return this.msgError("接口错误，上传失败"),!1;if(e.code===200){this.isUpload=!0,this.msgSuccess("上传成功");const t=e.url||e.payload[0],l=new Image;l.src=t,l.onload=()=>{h.fabric.Image.fromURL(t,n=>{n.left=0,n.top=0,this.img=n,this.canvas.setBackgroundImage(t,this.canvas.renderAll.bind(this.canvas)),this.updateCanvas()})}}else this.msgError("上传失败")},handleUploadSuccess2(e){if(!e)return this.msgError("接口错误，上传失败"),!1;if(e.code===200){this.msgSuccess("上传成功"),this.$refs.uploadRef.clearFiles();const t=e.url||e.payload[0];h.fabric.Image.fromURL(t,l=>{const n=this;n.canvas.add(l);function o(){l.animate({opacity:1},{duration:900,onChange:n.canvas.requestRenderAll.bind(n.canvas),onComplete:u})}function u(){l.animate({opacity:.5},{duration:1200,onChange:n.canvas.requestRenderAll.bind(n.canvas),onComplete:o})}o(),this.updateCanvas()})}else this.msgError("上传失败")},async onSubmit(){if(!this.isUpload){this.msgError("请上传图片！");return}this.$refs.formDataRef.validate(async e=>{if(e){const t=this.canvas.toJSON(["customParameters"]),l={...this.formData,detailVo:t};let n;this.currentOperateType===1?n=await saveImagInfo(l):n=await updateImagInfo(l),this.msgSuccess(n.msg),this.clearCanvas(),this.value={},this.currentObj={equipmentId:"",equipmentName:"",equipmentCode:null,latlog:"",quantity:null,status:""},this.formData={photoName:"",photoDesc:"",regionList:[],detailVo:null},this.resetForm("formDataRef")}else return!1})},clearCanvas(){this.canvas.clear(),this.isUpload=!1},updateCanvas(){this.canvas.renderAll()},saveToJson(){const e=this.canvas.toDatalessJSON(["customParameters"]);console.dir(e)},addTextBox(){const e=new h.fabric.Textbox("双击编辑文字",{width:100,left:100,top:100,fill:this.colorValue,opacity:.8,fontSize:this.fontSizeValue,cornerStyle:"circle",lineHeight:1,borderScaleFactor:1,splitByGrapheme:!0});e.setControlsVisibility({bl:!0,br:!0,mb:!1,mt:!1,tl:!0,tr:!0,mtr:!1}),e.controls.deleteControl=new h.fabric.Control(this.createDeleteControlData());const t="data:image/png;base64,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",l=document.createElement("img");l.src=t,e.controls.clone=new h.fabric.Control({x:-.5,y:-.5,offsetY:-16,offsetX:-16,cursorStyle:"pointer",mouseUpHandler:this.cloneObject,render:this.renderIcon(l),cornerSize:24}),this.canvas.add(e)},cloneObject(e,t){const l=t.target,n=l.canvas;l.clone(function(o){o.left+=20,o.top+=20,o.setControlsVisibility({bl:!0,br:!0,mb:!1,mt:!1,tl:!0,tr:!0,mtr:!1}),n.add(o)})},createDeleteControlData(){const e="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='utf-8'%3F%3E%3C!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3E%3Csvg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='595.275px' height='595.275px' viewBox='200 215 230 470' xml:space='preserve'%3E%3Ccircle style='fill:%23F44336;' cx='299.76' cy='439.067' r='218.516'/%3E%3Cg%3E%3Crect x='267.162' y='307.978' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -222.6202 340.6915)' style='fill:white;' width='65.545' height='262.18'/%3E%3Crect x='266.988' y='308.153' transform='matrix(0.7071 0.7071 -0.7071 0.7071 398.3889 -83.3116)' style='fill:white;' width='65.544' height='262.179'/%3E%3C/g%3E%3C/svg%3E",t=document.createElement("img");return t.src=e,{x:.5,y:-.5,offsetY:-16,offsetX:16,cursorStyle:"pointer",mouseUpHandler:this.deleteObject,render:this.renderIcon(t),cornerSize:24}},addRect(e){const t=new h.fabric.Rect({top:100,left:100,width:30,height:30,fill:"transparent",stroke:"#f00",strokeWidth:1,strokeUniform:!0,customParameters:{equipmentCode:e.equipmentCode,latlog:e.latlog,quantity:e.quantity,status:e.status,equipmentName:e.equipmentName,equipmentType:e.equipmentType}});this.canvas.add(t),this.updateCanvas()},addMarker(e){const t=new h.fabric.Path("M522.32192 383.01696v476.61056c0 12.6976-10.24 23.1424-22.81472 23.1424h-35.84a23.06048 23.06048 0 0 1-22.85568-23.1424V23.1424c0-12.6976 10.28096-23.1424 22.85568-23.1424h35.84c12.57472 0 22.81472 10.40384 22.81472 23.1424v33.5872c28.99968 23.18336 91.79136 68.32128 143.64672 68.32128 69.8368 0 172.35968 0.94208 216.8832 13.68064 28.99968 8.31488 68.28032 10.40384 95.68256 9.95328 17.36704-0.24576 28.54912 18.75968 20.31616 34.24256-25.8048 48.66048-85.85216 126.23872-85.85216 126.23872l73.07264 122.96192c10.24 17.12128-4.34176 38.46144-23.7568 34.73408a716.10368 716.10368 0 0 0-75.3664-10.19904c-72.0896-6.02112-249.52832 6.9632-295.64928-26.37824a1368.6784 1368.6784 0 0 0-68.97664-47.26784z m114.40128 306.87232c186.32704 21.05344 320.79872 80.81408 321.04448 150.97856 0 88.22784-209.63328 159.3344-468.54144 159.3344S20.48 928.64512 20.48 840.62208c0-69.2224 131.072-128.53248 313.9584-150.3232v42.63936c0 11.34592-8.23296 21.0944-19.21024 22.9376-102.03136 17.12128-170.8032 48.86528-170.8032 84.992 0 54.43584 154.4192 98.87744 344.59648 98.87744 190.17728 0 344.51456-44.2368 344.51456-98.63168 0-37.0688-71.68-69.2224-177.64352-86.17984a23.26528 23.26528 0 0 1-19.16928-22.9376v-42.10688z",{left:120,top:120,scaleX:.057983192903987554,scaleY:.057983192903987554,fill:"red",customParameters:{equipmentId:e.id,equipmentName:e.equipmentName,equipmentCode:e.equipmentCode}});t.setControlsVisibility({bl:!0,br:!0,mb:!1,ml:!1,mr:!1,mt:!1,tl:!0,tr:!0,mtr:!1}),this.canvas.add(t),new h.fabric.Circle({radius:5,fill:"blue",left:150,top:120,selectable:!1,originX:"center",originY:"center",hoverCursor:"auto"}),this.updateCanvas()},deleteObject(e,t){const l=t.target,n=l.canvas;n.remove(l),n.requestRenderAll()},renderIcon(e){return function(t,l,n,o,u){var a=this.cornerSize;t.save(),t.translate(l,n),t.rotate(h.fabric.util.degreesToRadians(u.angle)),t.drawImage(e,-a/2,-a/2,a,a),t.restore()}},init(){this.canvas=new h.fabric.Canvas("canvas",{});const e="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='utf-8'%3F%3E%3C!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3E%3Csvg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='595.275px' height='595.275px' viewBox='200 215 230 470' xml:space='preserve'%3E%3Ccircle style='fill:%23F44336;' cx='299.76' cy='439.067' r='218.516'/%3E%3Cg%3E%3Crect x='267.162' y='307.978' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -222.6202 340.6915)' style='fill:white;' width='65.545' height='262.18'/%3E%3Crect x='266.988' y='308.153' transform='matrix(0.7071 0.7071 -0.7071 0.7071 398.3889 -83.3116)' style='fill:white;' width='65.544' height='262.179'/%3E%3C/g%3E%3C/svg%3E";let t=document.createElement("img");t.src=e,h.fabric.Object.prototype.controls.deleteControl=new h.fabric.Control(this.createDeleteControlData()),this.canvas.on("mouse:wheel",a=>{let r=a.e.deltaY,d=this.canvas.getZoom();d*=.999**r,d>20&&(d=20),d<.01&&(d=.01),this.canvas.zoomToPoint({x:this.canvas.width/2,y:this.canvas.height/2},d),a.e.preventDefault(),a.e.stopPropagation()}),this.canvas.on("mouse:over",a=>{a.target&&a.target.type==="path"&&(a.target.set({fill:"green",stroke:"green"}),this.updateCanvas())}),this.canvas.on("mouse:out",a=>{a.target&&a.target.type==="path"&&(a.target.set({fill:"#f00",stroke:null}),this.updateCanvas())}),this.canvas.on("mouse:down",a=>{a.target?(this.target=a.target,this.currentObj={...a.target.customParameters}):(this.panning=!0,this.canvas.selection=!1)}),this.canvas.on("mouse:move",a=>{if(this.panning&&a&&a.e){let r=new h.fabric.Point(a.e.movementX,a.e.movementY);this.canvas.relativePan(r)}}),this.canvas.on("mouse:up",a=>{this.canvas.setViewportTransform(this.canvas.viewportTransform),this.canvas.isDragging=!1,this.panning=!1,this.canvas.selection=!0});const l=this;function n(a,r){const d=new h.fabric.Rect({top:a,left:r,width:100,height:100,fill:"transparent",stroke:"#f00",strokeWidth:1,strokeUniform:!0});l.canvas.add(d)}function o(a,r){l.canvas.add(new h.fabric.Circle({top:a,left:r,radius:30,fill:"pink"})),l.updateCanvas()}function u(a,r){h.fabric.Image.fromURL("./picture.jpg",d=>{d.top=a,d.left=r,l.canvas.add(d)})}this.canvas.on("drop",a=>{let r={left:this.canvas.getSelectionElement().getBoundingClientRect().left,top:this.canvas.getSelectionElement().getBoundingClientRect().top},d={x:a.e.x-r.left,y:a.e.y-r.top},m=this.canvas.restorePointerVpt(d);switch(this.currentType){case"rect":n(m.y,m.x);break;case"circle":o(m.y,m.x);break;case"img":u(m.y,m.x);break}this.currentType=null})}}},H={class:"baseStyle imgSetting"},_={key:0},$=I("canvas",{width:"1000",height:"500",id:"canvas",style:{border:"1px solid #ccc"}},null,-1),ee={style:{"word-break":"break-all"}},te={style:{"word-break":"break-all"}},ae={style:{"word-break":"break-all"}};function oe(e,t,l,n,o,u){const a=x,r=P,d=M,m=O,Q=J,w=z,S=j,k=Z,E=W,U=G,K=T,B=N,C=F("blur");return g(),v("div",H,[s(Y,{name:"el-fade-in-linear",mode:"out-in"},{default:i(()=>[o.showImg?(g(),v("div",_,[s(S,{gutter:20,style:{"margin-bottom":"10px"}},{default:i(()=>[s(r,{span:1.5},{default:i(()=>[f((g(),p(a,{size:"mini",icon:"el-icon-top-right",type:"primary",onClick:u.goToList},{default:i(()=>[A("查询列表")]),_:1},8,["onClick"])),[[C]])]),_:1}),s(r,{span:1.5},{default:i(()=>[s(d,{ref:"uploadRef",action:o.imgAction,multiple:!1,"show-file-list":!1,limit:1,data:o.obj,headers:o.headers,"before-upload":u.handleBeforeUpload,"on-success":u.handleUploadSuccess,"on-error":u.handlerError,accept:".jpg,.jpeg,.png,.gif,.svg"},{default:i(()=>[f((g(),p(a,{type:"primary",icon:"el-icon-plus",size:"mini"},{default:i(()=>[A("上传图片")]),_:1})),[[C]])]),_:1},8,["action","data","headers","before-upload","on-success","on-error"])]),_:1}),s(r,{span:1.5},{default:i(()=>[f((g(),p(a,{onClick:u.resetAllZoom,size:"mini",icon:"el-icon-refresh-right",type:"success"},{default:i(()=>[A("恢复")]),_:1},8,["onClick"])),[[C]])]),_:1}),s(r,{span:1.5},{default:i(()=>[f((g(),p(a,{onClick:u.clearCanvas,icon:"el-icon-delete",size:"mini",type:"danger"},{default:i(()=>[A("清空")]),_:1},8,["onClick"])),[[C]])]),_:1}),s(r,{span:1.5},{default:i(()=>[s(Q,{size:"mini",modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=c=>o.value=c),placeholder:"请选择设备",clearable:"",disabled:!o.isUpload,style:{width:"240px"},"value-key":"equipmentId",filterable:"",onChange:u.addRect},{default:i(()=>[(g(!0),v(V,null,b(o.list,(c,y)=>(g(),p(m,{key:y,label:c.equipmentName,value:c},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled","onChange"])]),_:1}),s(r,{span:1.5},{default:i(()=>[f((g(),p(a,{onClick:u.addRect,size:"mini",type:"success"},{default:i(()=>[A("添加框选")]),_:1},8,["onClick"])),[[C]]),f((g(),p(a,{onClick:u.addTextBox,size:"mini",type:"success"},{default:i(()=>[A("添加文本")]),_:1},8,["onClick"])),[[C]])]),_:1}),s(r,{span:1.5},{default:i(()=>[s(w,{modelValue:o.colorValue,"onUpdate:modelValue":t[1]||(t[1]=c=>o.colorValue=c),onChange:u.changeColor,onActiveChange:u.activeChange},null,8,["modelValue","onChange","onActiveChange"])]),_:1}),s(r,{span:1.5},{default:i(()=>[s(Q,{size:"mini",style:{width:"80px"},modelValue:o.fontWeightValue,"onUpdate:modelValue":t[2]||(t[2]=c=>o.fontWeightValue=c),onChange:u.changeFontWeight},{default:i(()=>[(g(!0),v(V,null,b(o.optionsFw,c=>(g(),p(m,{key:c.value,label:c.label,value:c.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1}),s(r,{span:1.5},{default:i(()=>[s(Q,{size:"mini",style:{width:"80px"},modelValue:o.fontSizeValue,"onUpdate:modelValue":t[3]||(t[3]=c=>o.fontSizeValue=c),onChange:u.changeFontSize},{default:i(()=>[(g(!0),v(V,null,b(o.optionsFS,c=>(g(),p(m,{key:c,label:c,value:c},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1})]),_:1}),s(S,null,{default:i(()=>[s(r,{span:20},{default:i(()=>[$]),_:1}),s(r,{span:4},{default:i(()=>[s(k,{size:"default"},{default:i(()=>[A("当前选中：")]),_:1}),s(U,{model:o.currentObj,ref:"form","label-width":"80px",inline:!1,size:"mini"},{default:i(()=>[s(E,{label:"设备id:",prop:"equipmentId"},{default:i(()=>[I("span",ee,q(o.currentObj.equipmentId),1)]),_:1}),s(E,{label:"设备名称:",prop:"equipmentName"},{default:i(()=>[I("span",te,q(o.currentObj.equipmentName),1)]),_:1}),s(E,{label:"设备编码:",prop:"equipmentCode"},{default:i(()=>[I("span",ae,q(o.currentObj.equipmentCode),1)]),_:1})]),_:1},8,["model"]),s(K),s(U,{model:o.formData,ref:"formDataRef","label-width":"80px",inline:!1,size:"mini",rules:o.rules},{default:i(()=>[s(E,{label:"名称:",prop:"photoName"},{default:i(()=>[s(B,{modelValue:o.formData.photoName,"onUpdate:modelValue":t[4]||(t[4]=c=>o.formData.photoName=c),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),s(E,{label:"备注:",prop:"photoDesc"},{default:i(()=>[s(B,{type:"textarea",autosize:{minRows:2},modelValue:o.formData.photoDesc,"onUpdate:modelValue":t[5]||(t[5]=c=>o.formData.photoDesc=c),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1}),s(E,null,{default:i(()=>[f((g(),p(a,{type:"primary",onClick:u.onSubmit},{default:i(()=>[A("保存")]),_:1},8,["onClick"])),[[C]])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})])):D("",!0)]),_:1})])}const ve=R(L,[["render",oe]]);export{ve as default};
