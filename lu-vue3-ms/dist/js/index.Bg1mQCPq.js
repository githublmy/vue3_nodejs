import{aL as C,d as O,bx as F,r as S,aB as x,as as I,at as L,cx as R,cy as U,aZ as E,ah as j,o as H,c as N,g as k,w as q,al as K,e as D,aw as G,am as $}from"./main.FTzGWMCm.js";import{i as W}from"./request.3uzDom6U.js";import"./tinymce.DRCiH91N.js";function Y(e,t){return W({url:"/files/upload",method:"post",data:e,onUploadProgress:t})}var Z=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],J=function(e){return Z.map(function(t){return t.toLowerCase()}).indexOf(e.toLowerCase())!==-1},Q=function(e,t,n){Object.keys(t).filter(J).forEach(function(l){var i=t[l];typeof i=="function"&&(l==="onInit"?i(e,n):n.on(l.substring(2),function(s){return i(s,n)}))})},X=function(e,t,n,l){var i=e.modelEvents?e.modelEvents:null,s=Array.isArray(i)?i.join(" "):i;C(l,function(v,o){n&&typeof v=="string"&&v!==o&&v!==n.getContent({format:e.outputFormat})&&n.setContent(v)}),n.on(s||"change input undo redo",function(){t.emit("update:modelValue",n.getContent({format:e.outputFormat}))})},ee=function(e,t,n,l,i,s){l.setContent(s()),n.attrs["onUpdate:modelValue"]&&X(t,n,l,i),Q(e,n.attrs,l)},A=0,V=function(e){var t=Date.now(),n=Math.floor(Math.random()*1e9);return A++,e+"_"+n+A+String(t)},ne=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},z=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},te=function(e,t){return z(e).concat(z(t))},ae=function(e){return e==null},P=function(){return{listeners:[],scriptId:V("tiny-script"),scriptLoaded:!1}},oe=function(){var e=P(),t=function(i,s,v,o){var a=s.createElement("script");a.referrerPolicy="origin",a.type="application/javascript",a.id=i,a.src=v;var m=function(){a.removeEventListener("load",m),o()};a.addEventListener("load",m),s.head&&s.head.appendChild(a)},n=function(i,s,v){e.scriptLoaded?v():(e.listeners.push(v),i.getElementById(e.scriptId)||t(e.scriptId,i,s,function(){e.listeners.forEach(function(o){return o()}),e.scriptLoaded=!0}))},l=function(){e=P()};return{load:n,reinitialize:l}},ie=oe(),re=function(){return typeof window<"u"?window:global},y=function(){var e=re();return e&&e.tinymce?e.tinymce:null},le={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},h=function(){return h=Object.assign||function(e){for(var t,n=1,l=arguments.length;n<l;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},h.apply(this,arguments)},se=function(e,t,n,l){return e(l||"div",{id:t,ref:n})},ce=function(e,t,n){return e("textarea",{id:t,visibility:"hidden",ref:n})},w={selector:void 0,target:void 0},ue=O({props:le,setup:function(e,t){var n=e.init?h(h({},e.init),w):h({},w),l=F(e),i=l.disabled,s=l.modelValue,v=l.tagName,o=S(null),a=null,m=e.id||V("tiny-vue"),c=e.init&&e.init.inline||e.inline,u=!!t.attrs["onUpdate:modelValue"],r=!0,p=e.initialValue?e.initialValue:"",g="",B=function(d){return u?function(){return s!=null&&s.value?s.value:""}:function(){return d?p:g}},_=function(){var d=B(r),f=h(h({},n),{readonly:e.disabled,target:o.value,plugins:te(n.plugins,e.plugins),toolbar:e.toolbar||n.toolbar,inline:c,setup:function(b){a=b,b.on("init",function(T){return ee(T,e,t,b,s,d)}),typeof n.setup=="function"&&n.setup(b)}});ne(o.value)&&(o.value.style.visibility=""),y().init(f),r=!1};C(i,function(d){var f;a!==null&&(typeof((f=a.mode)===null||f===void 0?void 0:f.set)=="function"?a.mode.set(d?"readonly":"design"):a.setMode(d?"readonly":"design"))}),C(v,function(d){var f;u||(g=a.getContent()),(f=y())===null||f===void 0||f.remove(a),x(function(){return _()})}),I(function(){if(y()!==null)_();else if(o.value&&o.value.ownerDocument){var d=e.cloudChannel?e.cloudChannel:"6",f=e.apiKey?e.apiKey:"no-api-key",b=ae(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(f,"/tinymce/").concat(d,"/tinymce.min.js"):e.tinymceScriptSrc;ie.load(o.value.ownerDocument,b,_)}}),L(function(){y()!==null&&y().remove(a)}),c||(R(function(){r||_()}),U(function(){var d;u||(g=a.getContent()),(d=y())===null||d===void 0||d.remove(a)}));var M=function(d){var f;g=a.getContent(),(f=y())===null||f===void 0||f.remove(a),n=h(h(h({},n),d),w),x(function(){return _()})};return t.expose({rerender:M,getEditor:function(){return a}}),function(){return c?se(E,m,o,e.tagName):ce(E,m,o)}}});const de={class:"baseStyle"},pe={__name:"index",setup(e){const t=S(),n=S(),l=()=>{},i=S(""),s=(o,a)=>new Promise((m,c)=>{const u=new FormData;u.append("file",o.blob(),o.filename()),fetch("http://localhost:3000/files/upload",{method:"post",body:u}).then(r=>r.json()).then(r=>{if(r.status===404){c({message:"HTTP Error: "+r.status,remove:!0});return}r.url,m(r.url)}).catch(r=>{console.dir(r,"错误"),c("上传失败，未知错误！")})}),v={selector:"#basic-tinymce",license_key:"gpl",height:500,width:"100%",placeholder:"请输入内容",promotion:!1,branding:!1,language:"zh_CN",skin_url:"/skins/ui/tinymce-5",attachment_max_size:100*1024*1024*1024,attachment_assets_path:"/plugins/attachment/icons",content_css:"/skins/custom/content.css",attachment_upload_handler:async function(o,a,m,c){const u=new FormData;u.append("file",o);try{const r=await Y(u,p=>{const g=(p.loaded/p.total*100|0)+"%";c(g)});a(r.url)}catch(r){m(`上传失败:${r}`)}},toolbar_mode:"wrap",plugins:`preview indent2em importcss searchreplace autolink autosave save directionality
     code visualblocks visualchars fullscreen image link media codesample table charmap
     pagebreak nonbreaking anchor insertdatetime advlist lists wordcount help
     quickbars emoticons accordion attachment`,menubar:"file edit view insert format tools table help",toolbar:`undo redo | styleselect formatselect fontselect fontsizeselect removeformat |
     blocks fontfamily fontsize | bold italic underline strikethrough subscript superscript hr blockquote |
     forecolor backcolor | align numlist bullist | link image media | table | lineheight indent2em outdent indent |
     charmap emoticons | accordion accordionremove | code codesample | fullscreen preview | save print |
     pagebreak anchor | ltr rtl | wordcount attachment`,line_height_formats:"1 1.1 1.2 1.3 1.4 1.5 2 3 4 5 6",font_size_input_default_unit:"px",font_size_formats:"12px 14px 16px 18px 20px 21px 22px 24px 26px 28px 30px 32px 34px 36px 48px 56px 72px",font_family_formats:"默认字体=Helvetica,sans-serif;微软雅黑=Microsoft YaHei,PingFang SC,sans-serif;苹果苹方=PingFang SC,Microsoft YaHei,sans-serif;宋体=simsun,serif;仿宋体=FangSong,serif;黑体=SimHei,sans-serif;Arial=arial,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Impact=impact,chicago; Symbol=symbol; Tahoma=tahoma,arial,helvetica,sans-serif; Terminal=terminal,monaco; Times New Roman=times new roman,times; Trebuchet MS=trebuchet ms,geneva; Verdana=verdana,geneva; Webdings=webdings; Wingdings=wingdings,zapf dingbats",importcss_append:!0,quickbars_image_toolbar:"alignleft aligncenter alignright | imageoptions",quickbars_selection_toolbar:"fontsize forecolor backcolor | align bold italic underline | quicklink h2 h3",quickbars_insert_toolbar:!1,content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px } img {max-width:100%;} video {max-width:100%;} ",images_reuse_filename:!0,image_title:!0,images_upload_handler:s,file_picker_types:"media image",file_picker_callback:function(o,a,m){if(m.filetype==="media"){var c=document.createElement("input");c.setAttribute("type","file"),c.setAttribute("accept","video/*"),c.onchange=function(){var u=this.files[0];if(u){const r=new FormData;r.append("file",u),fetch("http://localhost:3000/files/upload",{method:"POST",body:r}).then(p=>p.json()).then(p=>{o(p.url,{title:u.name})}).catch(p=>{})}},c.click()}if(m.filetype==="image"){var c=document.createElement("input");c.setAttribute("type","file"),c.setAttribute("accept","image/*"),c.onchange=function(){var r=this.files[0];if(r){const p=new FormData;p.append("file",r),fetch("http://localhost:3000/files/upload",{method:"POST",body:p}).then(g=>g.json()).then(g=>{o(g.url,{title:r.name})}).catch(g=>{})}},c.click()}},video_template_callback:o=>`<video width="${o.width}" controls="controls" poster="${o.poster}">
    <source src="${o.source}" type="video/mp4" />
    您的浏览器不支持 HTML5 视频标签。
  </video>`};return(o,a)=>{const m=$,c=j("Test");return H(),N("div",de,[k(m,{type:"primary",size:"default",onClick:l},{default:q(()=>[K("获取实例")]),_:1}),k(D(ue),{ref_key:"editorRef",ref:t,modelValue:D(i),"onUpdate:modelValue":a[0]||(a[0]=u=>G(i)?i.value=u:null),disabled:!1,"api-key":"aawnz0o8kigy7ia1ztfgziay1bsnneafniczu0c571v20cmz",init:v},null,8,["modelValue"]),k(c,{ref_key:"testRef",ref:n},null,512)])}}};export{pe as default};
